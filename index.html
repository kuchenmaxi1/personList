<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Personendatenbank</title>
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<style>
  #error-message {
  color: red;
  font-weight: bold;
  margin-top: 10px;
  animation: shake 0.5s;
}

.hidden {
  display: none;
}

@keyframes shake {
  0% {
    transform: translateX(0);
  }
  25% {
    transform: translateX(-5px);
  }
  50% {
    transform: translateX(5px);
  }
  75% {
    transform: translateX(-5px);
  }
  100% {
    transform: translateX(0);
  }
}
body {
  background-color: #e9ecef;
  color: #495057;
}
.container {
  margin-top: 50px;
}
h1 {
  color: #0d6efd;
}
.btn {
  margin-top: 10px;
}
.modal-header {
  background-color: #0d6efd;
  color: white;
}
.modal-body {
  background-color: #f8f9fa;
}
.table th,
.table td {
  text-align: center;
}
.form-label {
  font-weight: bold;
}
.card {
  margin-bottom: 20px;
}
.additional-fields {
  display: none;
}

</style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.0/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  </head>
  <body>
    <div class="container">
      <h1 class="text-center">Personendatenbank</h1>
      <div id="login" class="text-center">
        <h2>Login</h2>
        <input
          type="password"
          id="password"
          placeholder="Bitte gebe das richtige Passwort ein!"
          class="form-control"
        />
        <button id="loginButton" class="btn btn-primary">Login</button>
        <div id="error-message" class="hidden">Passwort falsch!</div>
      </div>
      <div id="content" style="display: none">
        <div class="text-center">
          <button id="addPersonButton" class="btn btn-success">
            Person hinzufügen
          </button>
          <button onclick="gotoCrush()" class="btn btn-success">
            Random Crush Generator
          </button>
          <button onclick="gotoChat()" class="btn btn-success">
            Chat Dantenbank
          </button>
          <button onclick="logout()" style="background-color: #f44336; color: white; padding: 10px 20px; border: none; cursor: pointer; border-radius: 5px;">
            <i class="fa fa-sign-out"></i> Logout
          </button>

          
          <input
            type="text"
            id="searchInput"
            placeholder="Gebe einen Suchbegriff ein!"
            class="form-control mt-2"
          />
        </div>
        <div id="personsList" class="mt-4"></div>
      </div>
    </div>

    <!-- Modal für Person hinzufügen/bearbeiten -->
  
      <div
        class="modal fade"
        id="personModal"
        tabindex="-1"
        aria-labelledby="personModalLabel"
        aria-hidden="true"
      >
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="personModalLabel">
                
              </h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <form id="personForm">
                <input type="hidden" id="personId" />
                <h4>Pflichtfelder:</h4>
                <div class="mb-3">
                  <label for="vorname" class="form-label">Vorname(n):</label>
                  <input
                    placeholder="Bitte gebe hier den bzw. die Vornamen ein!"
                    type="text"
                    class="form-control"
                    id="vorname"
                    required
                  />
                </div>
                <div class="mb-3">
                  <label for="nachname" class="form-label">Nachname:</label>
                  <input
                    placeholder="Bitte gebe den Nachnamen der Person ein!"
                    type="text"
                    class="form-control"
                    id="nachname"
                    required
                  />
                </div>
                <div class="mb-3">
                  <label for="geschlecht" class="form-label">Geschlecht:</label>
                  <select class="form-control" id="geschlecht" required>
                    <option value="">Bitte wähle das Geschlecht aus!</option>
                    <option value="männlich">Männlich</option>
                    <option value="weiblich">Weiblich</option>
                  </select>
                </div>
                <div class="mb-3">
                  <label for="alter" class="form-label">Alter:</label>
                  <input
                    placeholder="Bitte gebe hier das Alter der Person ein!"
                    type="number"
                    class="form-control"
                    id="alter"
                    required
                  />
                </div>
                <hr />
                <!-- Trennunng zwischen Pflicht und Weiteren Feldern -->
                <h4>Weitere Informationen:</h4>
                <h5>Geburtsdaten:</h5>
                <div class="mb-3">
                  <label for="geburtsdatum" class="form-label"
                    >Geburtsdatum:</label
                  >
                  <input
                    type="date"
                    class="form-control"
                    placeholder="Bitte gebe das Geburtsdatum der Person ein! Wenn es unbekannt ist gebe stattdesen das Jahr ein!"
                    id="geburtsdatum"
                  />
                </div>
                <div class="mb-3">
                  <label for="geburtsjahr" class="form-label"
                    >Geburtsjahr:</label
                  >
                  <input
                    type="number"
                    placheholder="Bitte gebe das Geburtsjahr der Person ein!"
                    class="form-control"
                    id="geburtsjahr"
                  />
                </div>
                <hr />
                <h5>Schulische Informationen:</h5>
                <div class="mb-3">
                  <label for="schule" class="form-label">Schule:</label>
                  <input
                    type="text"
                    placeholder="Welche Schule besucht die Person? (Bitte vollständigen Namen angeben)"
                    class="form-control"
                    id="schule"
                  />
                  <div class="mb-3">
                    <label for="klasse" class="form-label">Klasse:</label>
                    <input
                      type="text"
                      placeholder="Welche Klasse besucht die Person? (Bitte Namen angeben z.b. '7b', '8b' oder 'Q11'.)"
                      class="form-control"
                      id="klasse"
                    />
                    <hr />
                    <h5>Adresse(n):</h5>
                    <div class="mb-3">
                      <label for="adresse" class="form-label">Adresse:</label>
                      <input
                        type="text"
                        placeholder="Bitte gebe hier die Adresse ein!"
                        class="form-control"
                        id="adresse"
                      />
                    </div>
                    <div class="mb-3">
                      <label for="plz" class="form-label">Postleitzahl:</label>
                      <input
                        type="number"
                        placeholder="Bitte gebe hier die Postleitzahl ein!"
                        class="form-control"
                        id="plz"
                      />
                    </div>
                    <div class="mb-3">
                      <label for="gemeindename" class="form-label"
                        >Stadt:</label
                      >
                      <input
                        type="text"
                        placeholder="Bitte gebe hier den Stadt bzw. Gemeindenamen ein!"
                        class="form-control"
                        id="gemeindename"
                      />
                    </div>
                    <hr />
                    <h5>Äußerliches:</h5>
                    <div class="mb-3">
                      <label for="haarfarbe" class="form-label"
                        >Haarfarbe:</label
                      >
                      <input
                        type="text"
                        placeholder="Welche Haarfarbe hat die Person?"
                        class="form-control"
                        id="haarfarbe"
                      />
                    </div>
                    <div class="mb-3">
                      <label for="haarlaenge" class="form-label"
                        >Haarlänge (ungefähr):</label
                      >
                      <select class="form-control" id="haarlaenge">
                        <option value="keine Daten">Bitte Auswählen!</option>
                        <option value="sehr klein">sehr kurz</option>
                        <option value="klein">kurz</option>
                        <option value="mittel">mittel</option>
                        <option value="groß">lang</option>
                        <option value="sehr groß">sehr lang</option>
                      </select>
                    </div>
                    <div class="mb-3">
                      <label for="groesse" class="form-label"
                        >Größe (ungefähr; in cm):</label
                      >
                      <input
                        type="number"
                        placeholder="Bitte gebe hier die ungefähre Körpergröße der Person in cm ein!"
                        class="form-control"
                        id="groesse"
                      />
                    </div>
                    <div onclick="infoalert()" class="mb-3">
                      <label for="score" class="form-label"
                        >Score (1-10) Klicken für Infos!</label
                      >
                      <input
                        type="text"
                        placeholder="Bitte gebe hier den Score der Person ein! Wie gut sieht die Person aus?"
                        class="form-control"
                        id="score"
                        min="1"
                        max="10"
                      />
                    </div>
                    <hr />
                    <h4>Intime Informationen:</h4>
                    <hr />
                    <div style="display: none" id="weiblich">
                      <div class="mb-3">
                        <label for="brustgröße" class="form-label"
                          >Wie groß sind die Brüste der Person? (für ihr
                          Alter):</label
                        >
                        <select class="form-control" id="brustgröße">
                          <option value="keine Daten">Bitte Auswählen!</option>
                          <option value="sehr klein">Sehr klein</option>
                          <option value="klein">Klein</option>
                          <option value="mittel">Mittel</option>
                          <option value="groß">Groß</option>
                          <option value="sehr groß">Sehr groß</option>
                        </select>
                      </div>
                      <div class="mb-3">
                        <label for="busenbetont" class="form-label"
                          >Trägt die Person Busenbetonte Kleidung?</label
                        >
                        <select class="form-control" id="busenbetont">
                          <option value="keine Daten">Bitte Auswählen!</option>
                          <option value="nie">nie</option>
                          <option value="fast nie">fast nie</option>
                          <option value="gelegentlich">gelegentlich</option>
                          <option value="manchmal">manchmal</option>
                          <option value="oft">oft</option>
                          <option value="fast immer">fast immer</option>
                          <option value="immer">immer</option>
                        </select>
                      </div>
                      <div class="mb-3">
                        <label for="intimbehaarungw" class="form-label"
                          >Ist die Person an intimen Körperbereichen
                          behaart?</label
                        >
                        <select class="form-control" id="intimbehaarungw">
                          <option value="keine Daten">Bitte auswählen!</option>
                          <option value="nein">Nein</option>
                          <option value="wahrscheinlich nein">
                            Wahrscheinlich nein
                          </option>
                          <option value="eher nein">Eher nein</option>
                          <option value="mittel">Mittel</option>
                          <option value="eher ja">Eher ja</option>
                          <option value="wahrscheinlich ja">
                            Wahrscheinlich ja
                          </option>
                          <option value="ja">Ja</option>
                        </select>
                      </div>
                    </div>
                    <!-- Anfang männlich | Ende weiblich -->
                    <div style="display: none" id="männlich">
                      <div class="mb-3">
                        <label for="penislänge" class="form-label"
                          >Penislänge (im steifen Zustand):</label
                        >
                        <select class="form-control" id="penislänge">
                          <option value="keine Daten">Bitte Auswählen!</option>
                          <option value="sehr klein">Sehr klein</option>
                          <option value="klein">Klein</option>
                          <option value="mittel">Mittel</option>
                          <option value="groß">Groß</option>
                          <option value="sehr groß">Sehr groß</option>
                        </select>
                      </div>
                      <div class="mb-3">
                        <label for="intimbehaarungj" class="form-label"
                          >Ist die Person an intimen Körperbereichen
                          behaart?</label
                        >
                        <select class="form-control" id="intimbehaarungj">
                          <option value="keine Daten">Bitte auswählen!</option>
                          <option value="nein">Nein</option>
                          <option value="wahrscheinlich nein">
                            Wahrscheinlich nein
                          </option>
                          <option value="eher nein">Eher nein</option>
                          <option value="mittel">Mittel</option>
                          <option value="eher ja">Eher ja</option>
                          <option value="wahrscheinlich ja">
                            Wahrscheinlich ja
                          </option>
                          <option value="ja">Ja</option>
                        </select>
                      </div>
                      <div class="mb-3">
                        <label for="sixpack" class="form-label"
                          >Wie ist das Sixpack der Person ausgeprägt?</label
                        >
                        <select class="form-control" id="sixpack">
                          <option value="keine Daten">Bitte auswählen!</option>
                          <option value="nein">sehr schwach</option>
                          <option value="schwach">schwach</option>
                          <option value="eher schwach nein">
                            eher schwach
                          </option>
                          <option value="mäßig">mäßig</option>
                          <option value="eher stark">eher stark</option>
                          <option value="stark">stark</option>
                          <option value="sehr stark">sehr stark</option>
                        </select>
                      </div>
                    </div>
                    <div id="additionalFields" class="additional-fields"></div>
                    <hr />
                    <h5>Selbstbefriedigung:</h5>
                    <div class="mb-3">
                      <label for="masturbation" class="form-label"
                        >Masturbiert die Person?</label
                      >
                      <select class="form-control" id="masturbation">
                        <option value="keine Daten">Bitte auswählen!</option>
                        <option value="nein">Nein</option>
                        <option value="wahrscheinlich nein">
                          Wahrscheinlich nein
                        </option>
                        <option value="eher nein">Eher nein</option>
                        <option value="mittel">Mittel</option>
                        <option value="eher ja">Eher ja</option>
                        <option value="wahrscheinlich ja">
                          Wahrscheinlich ja
                        </option>
                        <option value="ja">Ja</option>
                      </select>
                    </div>
                    <hr />
                    <h5>Crushs bzw. Beziehungen:</h5>
                    <!-- Felder für Beziehungen -->
                    <div class="mb-3">
                      <label for="formerCrush" class="form-label"
                        >Ehemaliger Crush:</label
                      >
                      <input
                        type="text"
                        placeholder="Bitte gebe hier den ehemaligen Crush der Person ein!"
                        class="form-control"
                        id="formerCrush"
                      />
                    </div>
                    <div class="mb-3">
                      <label for="currentCrush" class="form-label"
                        >Aktueller Crush:</label
                      >
                      <input
                        type="text"
                        placeholder="Bitte gebe hier den aktuellen Crush der Person ein!"
                        class="form-control"
                        id="currentCrush"
                      />
                    </div>
                    <div class="mb-3">
                      <label for="formerRelation" class="form-label"
                        >Ehemalige Beziehung:</label
                      >
                      <input
                        type="text"
                        placeholder="Bitte gebe hier die ehemaligen Beziehungen ein!"
                        class="form-control"
                        id="formerRelation"
                      />
                    </div>
                    <div class="mb-3">
                      <label for="currentRelation" class="form-label"
                        >Aktuelle Beziehung:</label
                      >
                      <input
                        type="text"
                        placeholder="Bitte gebe hier die aktuelle Beziehungen ein!"
                        class="form-control"
                        id="currentRelation"
                      />
                    </div>
                    <hr />
                    <h5>Sexueller Kontakt:</h5>
                    <div class="mb-3">
                      <label for="sex" class="form-label"
                        >Ist die Person Jungfrau?</label
                      >
                      <select class="form-control" id="sex">
                        <option value="keine Daten">Bitte auswählen!</option>
                        <option value="nein">Nein</option>
                        <option value="wahrscheinlich nein">
                          Wahrscheinlich nein
                        </option>
                        <option value="eher nein">Eher nein</option>
                        <option value="mittel">Mittel</option>
                        <option value="eher ja">Eher ja</option>
                        <option value="wahrscheinlich ja">
                          Wahrscheinlich ja
                        </option>
                        <option value="ja">Ja</option>
                      </select>
                    </div>
                    <div class="mb-3">
                      <label for="mitwem" class="form-label"
                        >Weitere Informationen:</label
                      >
                      <textarea
                        placeholder="Hier kannst du weitere Informationen zum Thema eingeben. Zum Beispiel ob sie schonmal intimeren Kontakt mit anderen hatte!"
                        id="mitwem"
                        class="form-control"
                        rows="4"
                      ></textarea>
                    </div>
                    <hr />
                    <h5>Sonstiges:</h5>
                    <div class="mb-3">
                      <label for="additionalInfo" class="form-label"
                        >Zusätzliche Informationen:</label
                      >
                      <textarea
                        placeholder="Hier kannst du weitere Informationen zur Person eingeben. Zum Beispiel ob es irgendwelche Auffäligkeiten im Verhalten gibt!"
                        id="additionalInfo"
                        class="form-control"
                        rows="4"
                      ></textarea>
                    </div>
                    <hr />
                    <button type="submit" class="btn btn-primary">
                      Speichern
                    </button>
                    <button
                      type="button"
                      id="deletePersonButton"
                      class="btn btn-danger"
                    >
                      Person löschen
                    </button>
                    <hr />
                  </div>
                </div>
          </div>
        </div>
      </div>
        </div>
    <script>
      function infoalert() {
  alert(
    "Der Score bewertet das Aussehen der Person. Er kann von 1 sehr schlecht bis 10 sehr gut gehen. Der Score beruht vorallem auf Auftreten, Vorlieben und Entwicklung!"
  );
}

// Firebase-Konfiguration
const firebaseConfig = {
  apiKey: "AIzaSyAs3ugzFRBAcwHRAqF-71KJJ6f4h8Nn6H4",
  authDomain: "personlist-d93b1.firebaseapp.com",
  projectId: "personlist-d93b1",
  storageBucket: "personlist-d93b1.appspot.com",
  messagingSenderId: "21221546269",
  appId: "1:21221546269:web:fcbd9b1e8f3d0d6232b881",
};
firebase.initializeApp(firebaseConfig);
const database = firebase.database();
var admin = "yes"; // Die Zuweisung hier sollte ein String sein
$(document).ready(function () {
  $("#deletePersonButton").click(function () {
    if (admin === "no") {
      alert("Du bist nicht dazu berechtigt!");
    } else {
      const id = $("#personId").val();
      if (id) {
        database.ref("persons/" + id).remove();
        $("#personModal").modal("hide"); // Schließe das Modal
        loadPersons();
      }
    }
  });

  $("#loginButton").click(function () {
    const password = $("#password").val();
    // Überprüfe das Passwort (hier nur ein Beispiel)
    if (password === "test") {
      $("#login").hide();
      $("#content").show();
      loadPersons();
    } else if (password === "Test2") {
      $("#login").hide();
      $("#content").show();
      admin = "no"; // Setze admin auf "no"
      loadPersons();
    } else {
      alert("Falsches Passwort!");
      falsepassword();
    }
  });

  $("#addPersonButton").click(function () {
    document.getElementById("personModalLabel").innerText = "Neue Person hinzufügen";
    $("#personModal").modal("show");
    $("#personForm")[0].reset();
    $("#additionalFields").empty();
    $("#personId").val("");
    $("#deletePersonButton").hide();
  });

  $("#personForm").submit(function (event) {
    event.preventDefault(); // Verhindert das Standardverhalten des Formulars
    if (admin === "no") {
      alert("Du bist nicht dazu berechtigt!");
    } else {
      const id = $("#personId").val();
      const personData = {
        vorname: $("#vorname").val(),
        nachname: $("#nachname").val(),
        alter: $("#alter").val(),
        geburtsdatum: $("#geburtsdatum").val(),
        geburtsjahr: $("#geburtsjahr").val(),
        adresse: $("#adresse").val(),
        plz: $("#plz").val(),
        gemeindename: $("#gemeindename").val(),
        haarfarbe: $("#haarfarbe").val(),
        haarlänge: $("#haarlaenge").val(),
        größe: $("#groesse").val(),
        score: $("#score").val(),
        schule: $("#schule").val(),
        klasse: $("#klasse").val(),
        geschlecht: $("#geschlecht").val(),
        masturbation: $("#masturbation").val(),
        additionalInfo: $("#additionalInfo").val(),
        formerCrush: $("#formerCrush").val(),
        currentCrush: $("#currentCrush").val(),
        formerRelation: $("#formerRelation").val(),
        currentRelation: $("#currentRelation").val(),
        sex: $("#sex").val(),
        mitwem: $("#mitwem").val(),
        sixpack: $("#sixpack").val(),
        brustgröße: $("#brustgröße").val(),
        busenbetont: $("#busenbetont").val(),
        penislänge: $("#penislänge").val(),
        intimbehaarungw: $("#intimbehaarungw").val(),
        intimbehaarungj: $("#intimbehaarungj").val(),
        link: $("#link").val(),
      };

      if (id) {
        database.ref("persons/" + id).set(personData);
      } else {
        const newId = database.ref().child("persons").push().key;
        database.ref("persons/" + newId).set(personData);
      }

      $("#personModal").modal("hide"); // Schließe das Modal
      loadPersons(); // Aktualisiere die Liste
      const search = document.getElementById("searchInput");
      search.value = "";
    }
  });
});

$("#searchInput").keyup(function () {
  const searchTerm = $(this).val().toLowerCase();
  $("#personsList .card").each(function () {
    const name = $(this).find(".card-title").text().toLowerCase();
    $(this).toggle(name.includes(searchTerm));
  });
});

function loadPersons() {
  $("#personsList").empty();
  database.ref("persons").on("value", function (snapshot) {
    snapshot.forEach(function (childSnapshot) {
      const person = childSnapshot.val();
      const card = `
                      <div class="card">
                          <div class="card-body">
                              <h5 class="card-title">${person.vorname} ${person.nachname}</h5>
                              <p class="card-text">Alter: ${person.alter}</p>
                              <p class="card-text">ID: ${childSnapshot.key}</p>
                              <button class="btn btn-primary" onclick="editPerson('${childSnapshot.key}')">Bearbeiten</button>
                          </div>
                      </div>
                  `;
      $("#personsList").append(card);
    });
  });
}

window.editPerson = function (id) {
  database
    .ref("persons/" + id)
    .once("value")
    .then(function (snapshot) {
      const person = snapshot.val();
      $("#personId").val(id);
      $("#vorname").val(person.vorname);
      $("#nachname").val(person.nachname);
      $("#alter").val(person.alter);
      $("#geburtsdatum").val(person.geburtsdatum);
      $("#geburtsjahr").val(person.geburtsjahr);
      $("#adresse").val(person.adresse);
      $("#plz").val(person.plz);
      $("#gemeindename").val(person.gemeindename);
      $("#haarfarbe").val(person.haarfarbe);
      $("#haarlänge").val(person.haarlänge);
      $("#groesse").val(person.größe);
      $("#score").val(person.score);
      $("#geschlecht").val(person.geschlecht);
      $("#masturbation").val(person.masturbation);
      $("#additionalInfo").val(person.additionalInfo);
      $("#formerCrush").val(person.formerCrush);
      $("#currentCrush").val(person.currentCrush);
      $("#formerRelation").val(person.formerRelation);
      $("#currentRelation").val(person.currentRelation);
      $("#sex").val(person.sex);
      $("#mitwem").val(person.mitwem);
      $("#brustgröße").val(person.brustgröße);
      $("#busenbetont").val(person.busenbetont);
      $("#intimbehaarungj").val(person.intimbehaarungj);
      $("#penislänge").val(person.penislänge);
      $("#intimbehaarungw").val(person.intimbehaarungw);
      $("#sixpack").val(person.sixpack);
      $("#schule").val(person.schule);
      $("#klasse").val(person.klasse);
      $("#link").val(person.link);
      toggleAdditionalFields(person.geschlecht);
      $("#deletePersonButton").show();
      const neueUeberschrift = `${person.vorname} bearbeiten`;
      document.getElementById("personModalLabel").innerText = neueUeberschrift;
      $("#personModal").modal("show");
    });
};

$("#geschlecht").change(function () {
  const geschlecht = $(this).val();
  toggleAdditionalFields(geschlecht);
});

function toggleAdditionalFields(geschlecht) {
  $("#additionalFields").empty();
  if (geschlecht === "weiblich") {
    document.getElementById("männlich").style.display = "none";
    document.getElementById("weiblich").style.display = "block";
  } else if (geschlecht === "männlich") {
    document.getElementById("weiblich").style.display = "none";
    document.getElementById("männlich").style.display = "block";
  }
  $("#additionalFields").show();
}
function falsepassword() {
  const errorMessage = document.getElementById("error-message");
  errorMessage.classList.remove("hidden");

  // Animation hinzufügen
  errorMessage.style.animation = "none"; // Reset animation
  errorMessage.offsetHeight; // Trigger reflow
  errorMessage.style.animation = ""; // Start animation
}

    </script>
        
  </body>
</html>
